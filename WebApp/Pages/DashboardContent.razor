@inject AttendanceService AttendanceService
@inject NavigationManager nm

<div class="wrapper" style="font-family: 'Arial', sans-serif;">
    <!-- Dashboard Header -->
    <div class="container-fluid">
        <div class="row g-4">
            <div class="col-lg-3 col-md-6 col-12">
                <div class="small-box text-white text-center p-3 shadow-sm" style="min-width: 10rem; background-color: #4CAF50; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                    <div class="inner">
                        <h3 style="font-size: 2rem;">120</h3>
                        <p>Total Students</p>
                    </div>
                    <div class="icon my-3">
                        <i class="fas fa-users fa-2x"></i>
                    </div>
                    <a href="#" class="small-box-footer text-white" style="font-size: 1.1rem;">View Students <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-12">
                <div class="small-box bg-success text-white text-center p-3 shadow-sm" style="min-width: 10rem; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                    <div class="inner">
                        <h3 style="font-size: 2rem;">95%</h3>
                        <p>Attendance Today</p>
                    </div>
                    <div class="icon my-3">
                        <i class="fas fa-check-circle fa-2x"></i>
                    </div>
                    <a href="#" class="small-box-footer text-white" style="font-size: 1.1rem;">More Details <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-12">
                <div class="small-box bg-warning text-white text-center p-3 shadow-sm" style="min-width: 10rem; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                    <div class="inner">
                        <h3 style="font-size: 2rem;">12</h3>
                        <p>Absent Students</p>
                    </div>
                    <div class="icon my-3">
                        <i class="fas fa-user-times fa-2x"></i>
                    </div>
                    <a href="#" class="small-box-footer text-white" style="font-size: 1.1rem;">Check Absent List <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-12">
                <div class="small-box bg-danger text-white text-center p-3 shadow-sm" style="min-width: 10rem; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                    <div class="inner">
                        <h3 style="font-size: 2rem;">5</h3>
                        <p>Late Arrivals</p>
                    </div>
                    <div class="icon my-3">
                        <i class="fas fa-clock fa-2x"></i>
                    </div>
                    <a href="#" class="small-box-footer text-white" style="font-size: 1.1rem;">View Details <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid py-4">
        <div class="row g-4">
            <!-- Left Section -->
            <section class="col-lg-7">
                <!-- Attendance Chart -->
                <div class="card shadow-sm mb-4" style="border-radius: 12px;">
                    <div class="card-header bg-primary text-white fw-bold">
                        <h3 class="card-title m-0">
                            <i class="fas fa-chart-line me-2"></i> Monthly Attendance Overview
                        </h3>
                    </div>
                    <div class="card-body p-4">

                        @if (instructorDetails != null)
                        {
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Designation</th>
                                        <th>Department</th>
                                        <th>Faculty Type</th>
                                        <th>Total Regular Classes</th>
                                        <th>Total Makeup Classes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr @onclick="NavigateToTeacherDashboard" style="cursor: pointer;">
                                        <td>@instructorDetails.Name</td>
                                        <td>@instructorDetails.Designation</td>
                                        <td>@instructorDetails.Department</td>
                                        <td>@instructorDetails.FacultyType</td>
                                        <td>@instructorDetails.TotalRegularClasses</td>
                                        <td>@instructorDetails.TotalMakeupClasses</td>
                                    </tr>
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <p>No instructor details available</p>
                        }
                    </div>
                </div>

                <!-- Recent Attendance -->
                <div class="card shadow-sm mb-4" style="border-radius: 12px;">
                    <div class="card-header bg-info text-white fw-bold">
                        <h3 class="card-title m-0">Recent Attendance Records</h3>
                    </div>
                    <div class="card-body p-4">
                        <table class="table table-striped table-bordered">
                            <thead class="table-dark">
                                <tr>
                                    <th>Student Name</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>John Doe</td>
                                    <td><span class="badge bg-success">Present</span></td>
                                    <td>2024-11-23</td>
                                </tr>
                                <tr>
                                    <td>Jane Smith</td>
                                    <td><span class="badge bg-danger">Absent</span></td>
                                    <td>2024-11-23</td>
                                </tr>
                                <tr>
                                    <td>Michael Brown</td>
                                    <td><span class="badge bg-warning text-dark">Late</span></td>
                                    <td>2024-11-23</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Right Section -->
            <section class="col-lg-5">
                <!-- Attendance Insights -->
                <div class="card shadow-sm mb-4" style="border-radius: 12px;">
                    <div class="card-header bg-success text-white fw-bold">
                        <h3 class="card-title m-0">
                            <i class="fas fa-info-circle me-2"></i> Attendance Insights
                        </h3>
                    </div>
                    <div class="card-body p-4">
                        <p><strong>Class Average:</strong> 96%</p>
                        <p><strong>Top Performer:</strong> Sarah Lee</p>
                        <p><strong>Lowest Attendance:</strong> Tom White</p>
                    </div>
                </div>

                <!-- Notifications -->
                <div class="card shadow-sm mb-4" style="border-radius: 12px;">
                    <div class="card-header bg-warning text-dark fw-bold">
                        <h3 class="card-title m-0">
                            <i class="fas fa-bell me-2"></i> Notifications
                        </h3>
                    </div>
                    <div class="card-body p-4">
                        <ul style="list-style-type: none; padding: 0;">
                            <li><strong>Holiday Notice:</strong> No classes on 24th Nov.</li>
                            <li><strong>Exam Reminder:</strong> Science Test on 27th Nov.</li>
                            <li><strong>Event:</strong> Annual Sports Day on 1st Dec.</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

@code {
    private Instructor? instructorDetails;
    private List<AttendanceRecord>? attendanceRecords;

    private void NavigateToTeacherDashboard()
    {
        nm.NavigateTo("/TeacherDashboard");
    }

     private string className = "Class 10";
    private string subjectName = "Mathematics";
    private string teacherName = "John Smith";

    protected override void OnInitialized()
    {
        // Fetch instructor details and attendance records with proper arguments
        instructorDetails = AttendanceService.GetInstructorDetails(className, subjectName, teacherName)
            ?? new Instructor();
        attendanceRecords = AttendanceService.GetAttendanceRecords(className, subjectName)
            ?? new List<AttendanceRecord>();
    }
}